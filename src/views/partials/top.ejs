<%
  const isGoogleConfigured =
    typeof googleConfigured !== "undefined" ? googleConfigured : false;
  const isGoogleConnected =
    typeof googleConnected !== "undefined" ? googleConnected : false;
  const isTestProfileActive =
    typeof testProfileActive !== "undefined" ? testProfileActive : false;
  const activeTestProfile =
    typeof testProfile !== "undefined" && testProfile ? testProfile : null;
%>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %> | Appointment Vault</title>
    <link rel="stylesheet" href="/public/style.css" />
  </head>
  <body>
    <header class="site-header glass-nav">
      <div class="container header-inner">
        <a href="/" class="brand">Appointment Vault</a>
        <nav class="nav-links">
          <a class="button glass-button button-secondary" href="/">Home</a>
          <a class="button glass-button button-secondary" href="/appointments/new">Add Appointment</a>
          <a class="button glass-button button-secondary" href="/agent">AI Quick Add</a>
          <a class="button glass-button button-secondary" href="/checkin">Check-In</a>
          <a class="button glass-button button-secondary" href="/settings">Settings</a>
          <% if (isTestProfileActive && activeTestProfile) { %>
            <span class="test-profile-badge">
              Test: <%= activeTestProfile.name %>
            </span>
          <% } else if (isGoogleConfigured) { %>
            <% if (isGoogleConnected) { %>
              <form class="inline-nav-form" action="/auth/google/disconnect" method="POST">
                <button class="button glass-button button-secondary" type="submit">Disconnect Google</button>
              </form>
            <% } else { %>
              <a class="button glass-button button-secondary" href="/auth/google">Connect Google Calendar</a>
            <% } %>
          <% } %>
        </nav>
      </div>
    </header>
    <main class="container">
